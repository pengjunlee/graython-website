import{j as re,g as de,r as ue,m as pe,s as _e}from"./element-plus-8efUW2IF.js";import{b as me}from"./vue-router-DaOdIdNP.js";import{L as D,b as G,_ as Y,u as ve,i as he,d as ye,c as fe,e as be}from"./index-DXc6ExOT.js";import{b as ge,ax as ke,r,d as X,ah as B,o as y,c as g,L as d,P as k,T,U as m,u as s,G as we,a as t,S as C,V as N,M,a7 as q,n as Z,at as Ee,au as Se,J,Q as Te}from"./@vue-BV9Q_yhH.js";import{q as xe,p as Ce,z as Ae,A as Le}from"./@element-plus-DgtNr1CL.js";/* empty css              */import"./lodash-es-BDpUAi6D.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DVUPgnhb.js";import"./dayjs-Dc0JWrkO.js";import"./@ctrl-D_sRHO8g.js";import"./@popperjs-D9SI2xQl.js";import"./pinia-CWZPuNdE.js";import"./axios-Cm0UX6qg.js";import"./vue-pdf-embed-BcRweBTn.js";const Be=(l,o)=>{let n=!1;ge(()=>{n||l()}),ke(()=>{n&&o(),n=!0})},V="BLOSSOM-ARTICLE-FONT-SZIE",L=r(D.get(V)||.9),ze=()=>{L.value+=.1,D.set(V,L.value)},Ie=()=>{L.value-=.1,D.set(V,L.value)},Re=()=>L.value,Q=()=>L.value+"rem",We=l=>{let o=l.querySelectorAll("h1, h2, h3, h4, h5, h6"),n=[];for(let v=0;v<o.length;v++){let h=o[v],i=1,c=h.innerText,w=h.id;switch(h.localName){case"h1":i=1;break;case"h2":i=2;break;case"h3":i=3;break;case"h4":i=4;break;case"h5":i=5;break;case"h6":i=6;break}let a={content:c,clazz:"toc-"+i,id:w};n.push(a)}return n},Oe=l=>{let o=document.getElementById(l);o==null||o.scrollIntoView(!0)},Pe=l=>G(l.icon)&&(l.icon.startsWith("http")||l.icon.startsWith("https")),Ne=l=>G(l.icon),Me=l=>{let o=[];return l.t.forEach(n=>{n.toLocaleLowerCase()==="subject"?o.unshift({content:"专题",bgColor:"#565656",icon:"bl-a-lowerrightpage-line"}):n.toLocaleLowerCase()==="toc"?o.push({content:"目录",bgColor:"#939393"}):o.push({content:n})}),o},De=(l,o,n,v,h)=>{if(v==="copyPreCode"){let i=document.getElementById(h);if(i){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(i.innerText);{let c=document.createElement("textarea");return c.value=i.innerText,c.style.position="absolute",c.style.opacity="0",c.style.left="-999999px",c.style.top="-999999px",document.body.appendChild(c),c.focus(),c.select(),new Promise((w,a)=>{document.execCommand("copy")?w():a(),c.remove()})}}}},Ge={class:"detail"},Ve=X({__name:"ArticleSetting",setup(l){return(o,n)=>{const v=B("bl-tag"),h=re,i=B("bl-row");return y(),g("div",Ge,[d(i,null,{default:k(()=>[T(" 文章字体大小： "),d(v,{style:{"margin-right":"15px"}},{default:k(()=>[T(m(s(Re)().toFixed(1)),1)]),_:1}),d(h,{size:"small",icon:s(xe),onClick:n[0]||(n[0]=c=>s(ze)())},null,8,["icon"]),d(h,{size:"small",icon:s(Ce),onClick:n[1]||(n[1]=c=>s(Ie)())},null,8,["icon"])]),_:1})])}}}),Ke=Y(Ve,[["__scopeId","data-v-e099c7ab"]]),f=l=>(Ee("data-v-7136d778"),l=l(),Se(),l),$e={class:"articles-root"},je={class:"headmenu"},Fe=f(()=>t("div",{class:"iconbl bl-model-line"},null,-1)),Ue=f(()=>t("div",{style:{"font-size":"0.8rem"}},"文章列表",-1)),He=f(()=>t("div",{style:{"font-size":"0.8rem"}},"目录",-1)),qe=f(()=>t("div",{class:"iconbl bl-list-ordered"},null,-1)),Ze={class:"main"},Je={class:"doc-name"},Qe=["src"],Ye={key:1,class:"icon menu-icon","aria-hidden":"true"},Xe=["xlink:href"],et={key:0,class:"article-name"},tt=["innerHTML"],ot={class:"viewer-toc"},st={key:0,class:"doc-info"},lt={class:"doc-name",style:{"font-size":"15px"}},nt={class:"doc-subtitle"},at=f(()=>t("span",{class:"iconbl bl-pen-line"},null,-1)),it=f(()=>t("span",{class:"iconbl bl-read-line"},null,-1)),ct=f(()=>t("span",{class:"iconbl bl-like-line"},null,-1)),rt={class:"doc-subtitle"},dt=f(()=>t("span",{class:"iconbl bl-a-clock3-line"},null,-1)),ut={class:"doc-subtitle"},pt=f(()=>t("span",{class:"iconbl bl-a-clock3-line"},null,-1)),_t=f(()=>t("div",{class:"toc-title"},"目录",-1)),mt={class:"toc-content"},vt=["onClick"],ht=X({__name:"Articles",setup(l){const o=ve();Be(()=>{window.onHtmlEventDispatch=De,v(),window.addEventListener("resize",O),H()},()=>{v(),window.addEventListener("resize",O),H()}),we(()=>{window.removeEventListener("resize",O)});const n=r(),v=()=>{let e=h.query.articleId;ee(()=>{Z(()=>{n.value.setCurrentKey(c.value)})}),he(e)&&(c.value=e,j({ty:3,i:e}))},h=me(),i=r(!0),c=r(""),w=r([]),a=r({id:0,pid:0,name:"",tags:[],sort:0,starStatus:0,openStatus:0,type:3,html:`<div style="color:#E3E3E3;width:100%;height:300px;display:flex;justify-content: center;
    align-items: center;font-size:25px;">请在左侧菜单选择文章</div>`}),K=r([]),$=r([]),z=r(),ee=e=>{i.value=!0,w.value=[],$.value=[];const u=p=>{w.value=p.data,w.value.forEach(A=>{$.value.push(A.i.toString())}),e&&e()};ye().then(p=>u(p)).finally(()=>i.value=!1)},j=async e=>{e.ty==3&&(await te(e.i),window.history.replaceState("","","#/articles?articleId="+e.i),Z(()=>{z.value.scrollTo({top:0}),oe(z.value)}))},te=async e=>{if(e==="-999"){a.value.html=`<div style="color:#C6C6C6;font-weight: 300;width:100%;height:300px;padding:150px 20px;font-size:25px;text-align:center">
      该博客所配置的 USER_ID 为<br/><span style="color:#e3a300; border-bottom: 5px solid #e3a300;border-radius:5px">${window.blconfig.SYS.USER_ID}</span>
      </div>`;return}const u=p=>{var A;be(p.data)||(a.value=p.data,window.location.hostname!=="graython.us.kg"&&(a.value.html=(A=a.value.html)==null?void 0:A.replace("https://pengjunlee.us.kg/blossom-api","http://192.168.192.66:9999")))};await fe({id:e,showToc:!1,showMarkdown:!1,showHtml:!0}).then(p=>u(p))},oe=async e=>{K.value=We(e)},I=r(!1),se=()=>{I.value=!0},x=r({display:"none"}),R=r(!1),E=r({display:"none",opacity:0}),W=r(!1),S=r({display:"none",opacity:0}),F=e=>{R.value=e,e&&(x.value={display:"block"},E.value={display:"block",opacity:0},setTimeout(()=>{E.value={display:"block",opacity:1}},1)),e||(E.value={display:"block",opacity:0},setTimeout(()=>{E.value={display:"none",opacity:0}},300))},U=e=>{W.value=e,e&&(x.value={display:"block"},S.value={display:"block",opacity:0},setTimeout(()=>{S.value={display:"block",opacity:1}},1)),e||(S.value={display:"block",opacity:0},setTimeout(()=>{S.value={display:"none",opacity:0}},300))},H=()=>{let e=document.body.clientWidth;e>1100&&(E.value={display:"block",opacity:1}),e>1100&&(x.value={display:"none"},S.value={display:"block",opacity:1})},le=()=>{F(!1),U(!1),x.value={display:"none"}},O=()=>{let e=document.body.clientWidth;e<1100&&(R.value=!1,E.value={display:"none",opacity:0}),e>1100&&(x.value={display:"none"},E.value={display:"block",opacity:1}),e<1100&&(W.value=!1,S.value={display:"none",opacity:0}),e>1100&&(x.value={display:"none"},S.value={display:"block",opacity:1})};return(e,u)=>{const p=B("bl-row"),A=B("bl-tag"),ne=de,ae=ue,ie=pe,ce=_e;return y(),g(M,null,[t("div",$e,[t("div",{class:"mask",style:C(x.value),onClick:le},null,4),t("div",je,[d(p,{onClick:u[0]||(u[0]=b=>F(!R.value))},{default:k(()=>[Fe,Ue]),_:1}),d(p,{just:"flex-end",onClick:u[1]||(u[1]=b=>U(!W.value))},{default:k(()=>[He,qe]),_:1})]),t("div",Ze,[t("div",{class:"doc-tree-container",style:C(E.value)},[d(ne,{ref_key:"DocTreeRef",ref:n,class:"doc-tree",data:w.value,"highlight-current":!0,indent:14,icon:s(Ae),"node-key":"i",onNodeClick:j},{default:k(({_node:b,data:_})=>[t("div",{class:"menu-item-wrapper",style:C({marginTop:_.p==="0"?"5px":"1px",marginBottom:_.p==="0"?"5px":"1px"})},[t("div",{class:J([_.t.includes("subject")&&s(o).userParams.WEB_BLOG_SUBJECT_TITLE==="1"?"subject-title":"doc-title"])},[t("div",Je,[s(Pe)(_)?(y(),g("img",{key:0,class:"menu-icon-img",src:_.icon},null,8,Qe)):s(Ne)(_)?(y(),g("svg",Ye,[t("use",{"xlink:href":"#"+_.icon},null,8,Xe)])):N("",!0),t("div",{class:"name-wrapper",style:C({maxWidth:s(G)(_.icon)?"calc(100% - 25px)":"100%"})},m(_.n),5),(y(!0),g(M,null,q(s(Me)(_),P=>(y(),Te(A,{"bg-color":P.bgColor,icon:P.icon},{default:k(()=>[T(m(P.content),1)]),_:2},1032,["bg-color","icon"]))),256))])],2)],4)]),_:1},8,["data","icon"])],4),t("div",{class:"doc-content-container",ref_key:"PreviewRef",ref:z,style:C({fontSize:s(Q)()})},[s(o).userParams.WEB_BLOG_SHOW_ARTICLE_NAME==="1"?(y(),g("div",et,m(a.value.name),1)):N("",!0),d(ae,{font:{color:s(o).userParams.WEB_BLOG_WATERMARK_COLOR,fontSize:s(o).userParams.WEB_BLOG_WATERMARK_FONTSIZE,textBaseline:"hanging"},content:a.value.id>0&&s(o).userParams.WEB_BLOG_WATERMARK_ENABLED==="1"?s(o).userParams.WEB_BLOG_WATERMARK_CONTENT:"",gap:[s(o).userParams.WEB_BLOG_WATERMARK_GAP,s(o).userParams.WEB_BLOG_WATERMARK_GAP]},{default:k(()=>[t("div",{class:"bl-preview",style:C({fontSize:s(Q)()}),innerHTML:a.value.html},null,12,tt)]),_:1},8,["font","content","gap"])],4),t("div",{class:"toc-container",style:C(S.value)},[t("div",ot,[a.value.id!=0?(y(),g("div",st,[t("div",lt,m(a.value.name),1),t("div",nt,[at,T(" "+m(a.value.words)+" 字 | ",1),it,T(" "+m(a.value.uv)+" | ",1),ct,T(" "+m(a.value.likes),1)]),t("div",rt,[dt,T(" 公开 "+m(a.value.openTime),1)]),t("div",ut,[pt,T(" 修改 "+m(a.value.syncTime),1)])])):N("",!0),_t,t("div",mt,[(y(!0),g(M,null,q(K.value,b=>(y(),g("div",{key:b.id,class:J(["toc-item","link",b.clazz]),onClick:_=>s(Oe)(b.id)},m(b.content),11,vt))),128))])])],4),t("div",{class:"module-workbench",onClick:se},[d(ie,{style:{"font-size":"2rem"},color:"#7b7b7ba9"},{default:k(()=>[d(s(Le))]),_:1})])])]),d(ce,{modelValue:I.value,"onUpdate:modelValue":u[2]||(u[2]=b=>I.value=b),class:"center-drawer",direction:"btt","close-on-click-modal":!0,"with-header":!0,"destroy-on-close":!0,size:"7rem"},{default:k(()=>[d(Ke,{style:{"background-color":"var(--gw-bg-basic)"}})]),_:1},8,["modelValue"])],64)}}}),It=Y(ht,[["__scopeId","data-v-7136d778"]]);export{It as default};
